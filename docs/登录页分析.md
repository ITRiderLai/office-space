# 登录页分析文档

## 1. 页面概述

登录页是办公用房管理系统的入口页面，采用政务风格设计，整体呈现蓝色科技感。

## 2. 页面布局

页面采用全屏居中布局：
- 背景：蓝色渐变 + 城市建筑轮廓
- 标题：页面上方居中
- 登录卡片：页面中央

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│                   办公用房管理系统                            │
│                                                             │
│              ┌─────────────────────────┐                    │
│              │                         │                    │
│              │  用户名                  │                    │
│              │  ┌───────────────────┐  │                    │
│              │  │ 请输入用户名        │  │                    │
│              │  └───────────────────┘  │                    │
│              │                         │                    │
│              │  密码                    │                    │
│              │  ┌───────────────────┐  │                    │
│              │  │ 请输入密码          │  │                    │
│              │  └───────────────────┘  │                    │
│              │                         │                    │
│              │  验证码                  │                    │
│              │  ┌────────────┐ ┌────┐  │                    │
│              │  │ 请输入验证码 │ │6A79│  │                    │
│              │  └────────────┘ └────┘  │                    │
│              │                         │                    │
│              │  ☑ 记住密码              │                    │
│              │                         │                    │
│              │  ┌───────────────────┐  │                    │
│              │  │       登录         │  │                    │
│              │  └───────────────────┘  │                    │
│              │                         │                    │
│              └─────────────────────────┘                    │
│                                                             │
│  ░░░▓▓░░░▓▓▓░░░▓▓▓▓░░░▓▓▓░░░▓▓░░░▓▓▓▓░░░▓▓▓░░░▓▓░░░▓▓▓     │
│  城市建筑轮廓线条                                             │
└─────────────────────────────────────────────────────────────┘
```

## 3. 设计元素详解

### 3.1 背景

| 属性 | 值 |
|------|-----|
| 类型 | 背景图片 |
| 图片路径 | `src/assets/login/login-full-bg.png` |
| 主色调 | 蓝色渐变 + 城市建筑轮廓 |

**CSS 参考：**
```css
.login-page {
  background-image: url('@/assets/login/login-full-bg.png');
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}
```

### 3.2 系统标题

> 系统标题已包含在背景图片中，无需单独实现

### 3.3 登录卡片

| 属性 | 值 |
|------|-----|
| 背景色 | #FFFFFF |
| 宽度 | 500px |
| 内边距 | 40px |
| 圆角 | 8px |
| 阴影 | 轻微阴影效果 |

**CSS 参考：**
```css
.login-card {
  width: 500px;
  padding: 40px;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}
```

### 3.4 表单元素

#### 3.4.1 表单标签
| 属性 | 值 |
|------|-----|
| 字体大小 | 14px |
| 字体颜色 | #333 |
| 下边距 | 8px |

#### 3.4.2 输入框
| 属性 | 值 |
|------|-----|
| 高度 | 40px - 44px |
| 边框 | 1px solid #e0e0e0 |
| 圆角 | 4px |
| 背景色 | #f5f7fa 或 #fff |
| 占位符颜色 | #999 |

**输入框列表：**
| 字段 | 标签 | 占位符 | 类型 |
|------|------|--------|------|
| 用户名 | 用户名 | 请输入用户名 | text |
| 密码 | 密码 | 请输入密码 | password |
| 验证码 | 验证码 | 请输入验证码 | text |

#### 3.4.3 验证码图片
| 属性 | 值 |
|------|-----|
| 图片来源 | 通过 Mock 接口获取 |
| 实际图片 | `src/assets/login/login-yzm.jpg`（Mock 返回） |
| 宽度 | 约 100px |
| 高度 | 与输入框同高 40px |
| 交互 | 点击刷新验证码（重新调用接口） |

#### 3.4.4 记住密码
| 属性 | 值 |
|------|-----|
| 类型 | 复选框 + 文字 |
| 默认状态 | 选中 |
| 字体大小 | 14px |
| 字体颜色 | #666 |
| 选中高亮色 | `var(--global-primary-color)` 系统主题色 |

> 注意：复选框选中状态的高亮颜色必须使用系统主题色变量

#### 3.4.5 登录按钮
| 属性 | 值 |
|------|-----|
| 宽度 | 100% |
| 高度 | 44px - 48px |
| 背景色 | `var(--global-primary-color)` 系统主题色 |
| 字体颜色 | #fff |
| 字体大小 | 16px |
| 圆角 | 4px |
| 悬停效果 | 颜色加深 |

> 注意：按钮颜色必须使用系统主题色变量，不可写死颜色值

## 4. 交互设计

### 4.1 表单验证
1. **用户名**：必填，不能为空
2. **密码**：必填，不能为空
3. **验证码**：必填，需与图片验证码匹配

### 4.2 交互行为
| 操作 | 行为 |
|------|------|
| 点击验证码图片 | 刷新验证码 |
| 勾选"记住密码" | 下次登录自动填充用户名和密码 |
| 点击登录按钮 | 校验表单 → 提交登录请求 → 成功跳转首页 |
| 登录失败 | 显示错误提示，刷新验证码 |

### 4.3 键盘支持
- 输入框之间支持 Tab 键切换
- 在验证码输入框按 Enter 键触发登录

## 5. 数据结构

### 5.1 登录请求
```typescript
interface LoginParams {
  username: string    // 用户名
  password: string    // 密码
  captcha: string     // 验证码
  captchaKey: string  // 验证码key（用于后端校验）
  remember: boolean   // 是否记住密码
}
```

### 5.2 登录响应
```typescript
interface LoginResponse {
  code: number
  msg: string
  data: {
    token: string
    userId: string
    username: string
  }
}
```

## 6. API 接口

```typescript
// 获取验证码
POST /api/captcha
Response: {
  code: 200,
  data: {
    key: string,      // 验证码key
    image: string     // 图片地址
  }
}

// 用户登录
POST /api/user/login
Body: LoginParams
Response: LoginResponse
```

### 6.1 Mock 实现

验证码接口 Mock 实现：
```typescript
// mockjs/user.ts
Mock.mock(/\/api\/captcha/, 'post', () => {
  return {
    code: 200,
    msg: '操作成功',
    data: {
      key: 'mock-captcha-key-' + Date.now(),
      image: new URL('@/assets/login/login-yzm.jpg', import.meta.url).href
    }
  }
})
```

> 说明：Mock 接口返回固定图片路径，模拟真实验证码接口调用流程

## 7. 技术要点

### 7.1 验证码实现
- Mock 接口返回固定图片（`src/assets/login/login-yzm.jpg`）
- 点击刷新重新调用接口
- 登录失败后自动刷新
- 模拟真实接口调用流程，便于后续对接真实接口

### 7.2 记住密码
- 使用 localStorage 存储（加密）
- 或使用 cookie 存储

### 7.3 响应式适配
- 移动端：登录卡片宽度自适应，左右留边距
- 背景图使用 `background-size: cover` 适配不同屏幕

## 8. 与现有登录页对比

现有登录页文件：`src/views/login/index.vue`

| 特性 | 现有实现 | 设计稿要求 | 是否需要修改 |
|------|---------|-----------|-------------|
| 整体布局 | 左右布局（左蓝右白） | 全屏居中单卡片 | **是** |
| 背景 | 外部图片 | 蓝色渐变 + 城市轮廓 | **是** |
| 标题 | 左侧蓝色区域内 | 背景图片自带 | **是（移除代码）** |
| 登录方式 | 标签页（用户名/二维码） | 仅用户名 | **是** |
| 表单标签 | 无标签，有图标前缀 | 标签在输入框上方 | **是** |
| 输入框样式 | 带图标前缀 | 纯输入框 | **是** |
| 验证码 | 静态图片 | 可点击刷新 | 保持 |
| 记住密码 | 有 | 有 | 保持 |
| 其他登录 | 微信/钉钉/Gitee/Github | 无 | **是（移除）** |
| 登录按钮 | 蓝色，全宽 | 深蓝色，全宽 | 微调 |

**结论：创建新登录页，保留旧登录页**

### 8.1 文件规划

| 文件 | 说明 |
|------|------|
| `src/views/login/index.vue` | 新登录页（按设计稿实现） |
| `src/views/login/index.old.vue` | 旧登录页（保留备份） |

## 9. 开发清单

- [x] 备份旧登录页（重命名为 `index.old.vue`）
- [x] 创建新登录页 `index.vue`
  - [x] 页面整体布局（全屏居中单卡片）
  - [x] 设置背景图片（`src/assets/login/login-full-bg.png`，已含标题）
  - [x] 创建登录卡片（白色背景、圆角、阴影）
  - [x] 表单布局
    - [x] 用户名：标签 + 输入框
    - [x] 密码：标签 + 输入框
    - [x] 验证码：标签 + 输入框 + 验证码图片
    - [x] 记住密码复选框
    - [x] 登录按钮（使用系统主题色 `var(--global-primary-color)`）
  - [x] 验证码功能
    - [x] Mock 验证码接口（返回 `login-yzm.jpg`）
    - [x] 点击刷新调用接口
  - [x] 记住密码功能（localStorage）
  - [x] 表单验证
  - [x] 响应式适配（移动端）
  - [x] 复用现有登录逻辑
